<H3>Edit Order <%= @order.id %></H3>

<div class="table-wrapper borders">
<h4>Logistical Information</h4>
  <table class="no-borders">
    <caption>Basic Information</caption>
    <tbody>
      <tr>
        <td class="title-cell">Customer ID:</td>
        <td><%= @order.user_id %></td>
      </tr>
      <tr>
        <td class="title-cell">Customer:</td>
        <td><%= link_to("#{@order.user.first_name} #{@order.user.last_name}", admin_user_path(@order.user_id)) %></td>
      </tr>
      <tr>
        <td class="title-cell">Date Placed:</td>
        <td><%= @order.checkout_date.nil? ? "N/A" : @order.checkout_date.strftime("%m/%d/%y") %></td>
      </tr>
    </tbody>
  </table>

  <%= link_to("Edit Customer Profile", edit_admin_user_path(@order.user_id)) %><br>


  <div class="form-wrapper">
    <%= form_for( [:admin, @order], html: { :class => "form-horizontal" } ) do |f| %>
      
      <div class="form-group">
        <%= radio_button_tag(:checkout_date, "") %>
        <%= label_tag(:checkout_date, "PLACED", class: "green-mark") %><br>
        <%= radio_button_tag(:checkout_date, "", :checked => true) %>
        <%= label_tag(:checkout_date, "NOT PLACED", class: "red-mark") %>
      </div>

      <div class="form-group">
        <%= f.label :shipping_id, "Shipping Address:", class: "col-sm-4 control-label" %>
        <div class="col-sm-8">
          <%= f.collection_select :shipping_id, Address.where(:user_id => @order.user_id), :id, :street_address, {}, :class => "form-control"%>
        </div>
      </div>
        <%= f.hidden_field :user_id, :value => @order.user_id %>
      <div class="form-group">
        <%= f.label :billing_id, "Billing Address:", class: "col-sm-4 control-label" %>
        <div class="col-sm-8">
          <%= f.collection_select :billing_id, Address.where(:user_id => @order.user_id), :id, :street_address, {}, :class => "form-control"%>
        </div>
      </div>
      <div class="form-group">
        <%= f.label :credit_card_id, "Billing Card:", class: "col-sm-4 control-label" %>
        <div class="col-sm-8">
          <%= f.collection_select :credit_card_id, @order.user.credit_cards, :id, :card_number, {}, :class => "form-control"%>
        </div>
      </div>

      <div class="button-wrapper col-sm-12">
        <%= f.submit "Update Order Information", class: "btn btn-primary btn-group btn-group-lg" %>
      </div>
    <% end %>
  </div>

  <div class="link-wrapper-centre">
    <%= link_to("Delete Order", 
                "/admin/orders/#{@order.id}", 
                :method => "DELETE", 
                data: {confirm: "Are you sure?"}) %>
  </div>
</div>


<!-- =========EDIT ORDER========== -->
<div class="table-wrapper borders">
<div class="form-wrapper">
    <%= form_for( @order, :url => {:controller => 'admin/order_contents', :action => :edit, :action => :update}, html: { :class => "form-horizontal" } ) do |f| %>
    <table class="table table-striped">
      <caption>Edit Order Contents</caption>
      <thead>
        <tr>
          <th>ID</th>
          <th>Quantity</th>
          <th>Price</th>
          <th>Total Price</th>
          <th>REMOVE</th>
        </tr>
      </thead>
      <tbody>
        <% @order.order_contents.each do |cont| %>
          <tr>
            <td><%= cont.product_id %></td>
            <%= f.hidden_field :order_contents_id, :value => cont.product_id %>
            <%= f.hidden_field :quantity, :value => cont.quantity %>
            <td><%= f.text_field :quantity, :value => cont.quantity, :class => "form-control"%></td>
            <td><%= number_to_currency(cont.product.price, :unit => "$") %></td>
            <td><%= number_to_currency(cont.quantity*cont.product.price, :unit => "$") %></td>
            <td><%= link_to("delete", "/admin/order_contents/#{cont.id}", 
                            :method => "DELETE", 
                            data: {confirm: "Are you sure?"}) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <div class="button-wrapper col-sm-12">
      <%= f.submit "Update Order Contents", class: "btn btn-primary btn-group btn-group-lg" %>
    </div>
  <% end %>
</div>
</div>

<!-- =========ADD PRODUCTS============= -->

<div class="table-wrapper borders">
  <table class="table table-striped">
    <caption>
      Add Products to Order
      <h6>Add Up to 5 products at a time</h6>
    </caption>
    <thead>
      <tr>
        <th>ProductID</th>
        <th>Quantity</th>
      </tr>
    </thead>
    <tbody>
      <% @order.order_contents.each do |cont| %>
        <tr>
          <td><%= cont.product_id %></td>
          <td><%= cont.quantity %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>




